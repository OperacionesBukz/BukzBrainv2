import{v as Ye,j as e,d as h,f as Ze,g as V,I as te,a as es,h as ss,r as l,q as _e,w as Be,c as xe,o as Ve,m as qe,n as we,e as _,i as T,S as as,x as ts,y as rs,z as ns,s as Re,p as He,t as os}from"./index-zZ0VZZ4p.js";import{P as ls,M as De,a as is,D as k,b as ds,c as cs,C as $e}from"./progress-7-9TUhpN.js";import{C as me,T as Te}from"./textarea-FeWkwKSv.js";import{S as G,a as J,b as Q,c as W,d as Y,D as xs,e as ms,f as us,g as hs,h as gs}from"./dialog-CO3Lc6Ku.js";import{f as B,C as ps}from"./format-Cu5othT5.js";import{e as fs,U as js}from"./es-BuEom4ST.js";import{C as bs}from"./calendar-B9_EqBkT.js";import{C as vs}from"./chevron-right-BSo9J0aP.js";import{T as Ce,P as X}from"./trash-2-BdXGZdJo.js";import"./index-crZK1vcL.js";import"./index-DPxdIXPI.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Ye("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),re=["Baja","Media","Alta","Urgente"],ys=["operaciones@bukz.co","cedi@bukz.co","ux@bukz.co"],Je=[{email:"operaciones@bukz.co",label:"Operaciones"},{email:"cedi@bukz.co",label:"CEDI"},{email:"ux@bukz.co",label:"UX"}],Se={Baja:"bg-muted text-muted-foreground border border-border",Media:"bg-info/15 text-info",Alta:"bg-warning/15 text-warning",Urgente:"bg-destructive/15 text-destructive"},Ke=a=>B(new Date(a+"T00:00:00"),"dd MMM",{locale:fs}),Xe=a=>a?new Date(a+"T00:00:00"):void 0,Ge=({task:a,index:L,expandedTasks:j,toggleExpand:q,updateTask:w,deleteTask:Z,addSubtask:D,toggleSubtask:E,updateSubtaskTitle:M,deleteSubtask:A})=>{const u=a.subtasks.filter(C=>C.completed).length,b=a.subtasks.length,ee=b>0?u/b*100:0,g=a.status==="done",I=j[a.id],P=new Date;P.setHours(0,0,0,0);const v=a.dueDate?new Date(a.dueDate+"T00:00:00")<P&&!g:!1;return e.jsx(ls,{draggableId:a.id,index:L,children:(C,o)=>e.jsxs("div",{ref:C.innerRef,...C.draggableProps,...C.dragHandleProps,className:h("rounded-xl border border-border transition-shadow",g?"bg-success/10 border-success/30":"bg-card",o.isDragging&&"shadow-lg"),children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3",children:[e.jsx("button",{onClick:()=>w(a.id,{status:g?"todo":"done"}),className:h("shrink-0 transition-theme",g?"text-success":"text-muted-foreground hover:text-primary"),children:g?e.jsx(bs,{className:"h-5 w-5"}):e.jsx(ps,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>q(a.id),className:"text-muted-foreground",children:I?e.jsx(Ze,{className:"h-4 w-4"}):e.jsx(vs,{className:"h-4 w-4"})}),a.notes&&e.jsx(De,{className:"h-3 w-3 text-foreground fill-yellow-400 animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("input",{value:a.title,onChange:r=>w(a.id,{title:r.target.value}),onKeyDown:r=>r.key==="Enter"&&r.currentTarget.blur(),className:h("text-sm font-medium bg-transparent outline-none w-full",g?"text-success line-through":"text-foreground")}),b>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx(is,{value:ee,className:"h-1.5 flex-1"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground whitespace-nowrap",children:[u,"/",b]})]}),a.assignedBy&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground bg-primary/10 px-1.5 py-0.5 rounded border border-primary/20 w-fit",children:[e.jsx(js,{className:"h-2.5 w-2.5"}),e.jsxs("span",{className:"truncate max-w-[150px]",children:["Asignada por ",a.assignedBy.split("@")[0]]})]}),(a.startDate||a.dueDate)&&e.jsxs("div",{className:h("flex items-center gap-1 mt-1 text-xs px-1.5 py-0.5 rounded border w-fit",v?"text-destructive bg-destructive/10 border-destructive/30":"text-muted-foreground bg-muted/50 border-border"),children:[e.jsx(me,{className:"h-2.5 w-2.5"}),e.jsxs("span",{children:[a.startDate&&Ke(a.startDate),a.startDate&&a.dueDate&&" → ",a.dueDate&&Ke(a.dueDate)]})]})]}),e.jsxs(G,{value:a.priority,onValueChange:r=>w(a.id,{priority:r}),children:[e.jsx(J,{className:h("h-auto w-auto min-w-[80px] px-2 py-0.5 text-xs rounded-full font-medium border-0 gap-1 focus:ring-1",Se[a.priority]||"bg-muted text-muted-foreground"),children:e.jsx(Q,{})}),e.jsx(W,{children:re.map(r=>{var N;return e.jsx(Y,{value:r,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:h("w-2 h-2 rounded-full",((N=Se[r])==null?void 0:N.replace(/text-\S+/,""))||"bg-muted")}),r]})},r)})})]}),e.jsx("button",{onClick:()=>Z(a.id),className:"text-muted-foreground hover:text-destructive transition-theme",children:e.jsx(Ce,{className:"h-3.5 w-3.5"})})]}),I&&e.jsxs("div",{className:"border-t border-border px-4 py-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Subtareas (",u,"/",b,")"]}),e.jsxs(V,{variant:"ghost",size:"sm",onClick:()=>D(a.id),className:"h-6 text-xs gap-1",children:[e.jsx(X,{className:"h-3 w-3"})," Agregar"]})]}),e.jsx("div",{className:"space-y-1",children:a.subtasks.map(r=>e.jsxs("div",{className:"group/sub flex items-center gap-2 rounded-lg bg-muted/50 px-3 py-1.5",children:[e.jsx("input",{type:"checkbox",checked:r.completed,onChange:()=>E(a.id,r.id),className:"accent-primary h-3.5 w-3.5"}),e.jsx("input",{value:r.title,onChange:N=>M(a.id,r.id,N.target.value),className:h("flex-1 bg-transparent text-sm text-foreground outline-none",r.completed&&"line-through text-muted-foreground")}),e.jsx("button",{onClick:()=>A(a.id,r.id),className:"opacity-0 group-hover/sub:opacity-100 text-muted-foreground hover:text-destructive transition-all",children:e.jsx(Ce,{className:"h-3 w-3"})})]},r.id))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(me,{className:"h-3 w-3"})," Fechas"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground whitespace-nowrap w-10 shrink-0",children:"Inicio"}),e.jsx(k,{value:Xe(a.startDate),onChange:r=>w(a.id,{startDate:r?B(r,"yyyy-MM-dd"):void 0}),placeholder:"Sin fecha",className:"h-8 flex-1 text-xs"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("label",{className:h("text-xs whitespace-nowrap w-10 shrink-0",v?"text-destructive":"text-muted-foreground"),children:"Límite"}),e.jsx(k,{value:Xe(a.dueDate),onChange:r=>w(a.id,{dueDate:r?B(r,"yyyy-MM-dd"):void 0}),placeholder:"Sin fecha",className:h("h-8 flex-1 text-xs",v&&"border-destructive/50 bg-destructive/5 text-destructive")})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(De,{className:"h-3 w-3"})," Notas"]}),e.jsx(Te,{value:a.notes,onChange:r=>w(a.id,{notes:r.target.value}),placeholder:"Agregar notas...",className:"min-h-[60px] text-sm resize-none"})]})]})]})},a.id)},Ns=({open:a,onOpenChange:L,assignTitle:j,setAssignTitle:q,assignPriority:w,setAssignPriority:Z,assignTo:D,setAssignTo:E,assignNotes:M,setAssignNotes:A,assignSubtasks:u,setAssignSubtasks:b,assignStartDate:ee,setAssignStartDate:g,assignDueDate:I,setAssignDueDate:P,assignTask:v,userEmail:C})=>e.jsx(xs,{open:a,onOpenChange:L,children:e.jsxs(ms,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsx(us,{children:e.jsx(hs,{children:"Asignar tarea a otro usuario"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Usuario destino"}),e.jsxs(G,{value:D,onValueChange:E,children:[e.jsx(J,{children:e.jsx(Q,{placeholder:"Selecciona un usuario..."})}),e.jsx(W,{children:Je.filter(o=>o.email!==C).map(o=>e.jsxs(Y,{value:o.email,children:[o.label," (",o.email,")"]},o.email))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Título de la tarea"}),e.jsx(te,{placeholder:"Título de la tarea...",value:j,onChange:o=>q(o.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Prioridad"}),e.jsxs(G,{value:w,onValueChange:Z,children:[e.jsx(J,{children:e.jsx(Q,{})}),e.jsx(W,{children:re.map(o=>e.jsx(Y,{value:o,children:o},o))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(me,{className:"h-3.5 w-3.5"})," Fecha inicio"]}),e.jsx(k,{value:ee,onChange:g,placeholder:"Inicio"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(me,{className:"h-3.5 w-3.5"})," Fecha límite"]}),e.jsx(k,{value:I,onChange:P,placeholder:"Límite"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(De,{className:"h-3.5 w-3.5"})," Notas"]}),e.jsx(Te,{placeholder:"Agregar notas a la tarea...",value:M,onChange:o=>A(o.target.value),className:"min-h-[80px] text-sm resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Subtareas (",u.length,")"]}),e.jsxs(V,{variant:"ghost",size:"sm",onClick:()=>{b([...u,{id:`st${Date.now()}`,title:"",completed:!1}])},className:"h-7 text-xs gap-1",children:[e.jsx(X,{className:"h-3 w-3"})," Agregar Subtarea"]})]}),u.length>0&&e.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto",children:u.map((o,r)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{placeholder:`Subtarea ${r+1}...`,value:o.title,onChange:N=>{const S=[...u];S[r].title=N.target.value,b(S)},className:"flex-1 text-sm"}),e.jsx("button",{onClick:()=>{b(u.filter((N,S)=>S!==r))},className:"text-muted-foreground hover:text-destructive transition-theme",children:e.jsx(Ce,{className:"h-4 w-4"})})]},o.id))})]})]}),e.jsxs(gs,{children:[e.jsx(V,{variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),e.jsxs(V,{onClick:v,disabled:!j.trim()||!D,children:[e.jsx(ke,{className:"h-4 w-4 mr-2"})," Asignar Tarea"]})]})]})}),zs=()=>{const{user:a}=es(),L=ss(),[j,q]=l.useState([]),[w,Z]=l.useState({}),[D,E]=l.useState(""),[M,A]=l.useState("Media"),[u,b]=l.useState(!0),[ee,g]=l.useState(!1),[I,P]=l.useState("create"),[v,C]=l.useState(!1),[o,r]=l.useState(!1),[N,S]=l.useState(void 0),[ne,oe]=l.useState(void 0),ue=()=>{!v||o||(r(!0),E(""),A("Media"),S(void 0),oe(void 0))};l.useEffect(()=>{if(!v)return;const s=n=>{n.key==="Escape"&&ue()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[v,o]);const Ee=ys.includes((a==null?void 0:a.email)||""),[Qe,he]=l.useState(!1),[se,ge]=l.useState(""),[pe,fe]=l.useState("Media"),[ae,je]=l.useState(""),[be,ve]=l.useState(""),[Me,Ae]=l.useState([]),[le,ye]=l.useState(void 0),[ie,Ne]=l.useState(void 0);l.useEffect(()=>{if(!a)return;const s=_e(xe(_,"user_tasks"),Be("userId","==",a.uid)),n=_e(xe(_,"user_tasks"),Be("assignedTo","==",a.email)),t=new Map,p=()=>{const f=Array.from(t.values());f.sort((O,i)=>(i.order??0)-(O.order??0)),q(f),b(!1)},c=Ve(s,f=>{f.docs.forEach(i=>{var m,x;t.set(i.id,{id:i.id,...i.data(),order:i.data().order??((x=(m=i.data().createdAt)==null?void 0:m.toMillis)==null?void 0:x.call(m))??Date.now()})});const O=new Set(f.docs.map(i=>i.id));t.forEach((i,m)=>{const x=t.get(m);x&&!x.assignedTo&&!O.has(m)&&t.delete(m)}),p()},f=>{console.error("Error fetching own tasks:",f),b(!1)}),y=Ve(n,f=>{const O=new Set(f.docs.map(i=>i.id));t.forEach((i,m)=>{i.assignedTo===a.email&&!O.has(m)&&t.delete(m)}),f.docs.forEach(i=>{var m,x;t.set(i.id,{id:i.id,...i.data(),order:i.data().order??((x=(m=i.data().createdAt)==null?void 0:m.toMillis)==null?void 0:x.call(m))??Date.now()})}),p()},f=>{console.error("Error fetching assigned tasks:",f),b(!1)});return()=>{c(),y()}},[a]);const de=async()=>{if(!D.trim()||!a)return!1;try{const s={title:D.trim(),priority:M,status:"todo",notes:"",subtasks:[],userId:a.uid,createdAt:Re(),order:Date.now()};return N&&(s.startDate=B(N,"yyyy-MM-dd")),ne&&(s.dueDate=B(ne,"yyyy-MM-dd")),await He(xe(_,"user_tasks"),s),E(""),A("Media"),S(void 0),oe(void 0),T.success("Tarea agregada"),!0}catch(s){return console.error("Error adding task:",s),T.error("Error al guardar la tarea"),!1}},Ie=async()=>{if(!(!se.trim()||!ae||!a))try{const s={title:se.trim(),priority:pe,status:"todo",notes:be.trim(),subtasks:Me,userId:"",assignedTo:ae,assignedBy:a.email||"Desconocido",createdAt:Re(),order:Date.now()};le&&(s.startDate=B(le,"yyyy-MM-dd")),ie&&(s.dueDate=B(ie,"yyyy-MM-dd")),await He(xe(_,"user_tasks"),s),ge(""),fe("Media"),je(""),ve(""),Ae([]),ye(void 0),Ne(void 0),he(!1),T.success("Tarea asignada correctamente")}catch(s){console.error("Error assigning task:",s),T.error("Error al asignar la tarea")}},Pe=s=>{Z(n=>({...n,[s]:!n[s]}))},R=async(s,n)=>{try{const t=we(_,"user_tasks",s);await qe(t,n)}catch(t){console.error("Error updating task:",t),T.error("Error al actualizar la tarea")}},ze=async s=>{try{await os(we(_,"user_tasks",s)),T.success("Tarea eliminada")}catch(n){console.error("Error deleting task:",n),T.error("Error al eliminar la tarea")}},Fe=async s=>{const n=j.find(p=>p.id===s);if(!n)return;const t=[...n.subtasks,{id:`ps${Date.now()}`,title:"Nueva subtarea",completed:!1}];await R(s,{subtasks:t})},Le=async(s,n)=>{const t=j.find(c=>c.id===s);if(!t)return;const p=t.subtasks.map(c=>c.id===n?{...c,completed:!c.completed}:c);await R(s,{subtasks:p})},Oe=async(s,n,t)=>{const p=j.find(y=>y.id===s);if(!p)return;const c=p.subtasks.map(y=>y.id===n?{...y,title:t}:y);await R(s,{subtasks:c})},Ue=async(s,n)=>{const t=j.find(c=>c.id===s);if(!t)return;const p=t.subtasks.filter(c=>c.id!==n);try{await R(s,{subtasks:p})}catch(c){console.error("Error deleting subtask:",c),T.error("Error al eliminar la subtarea")}},H=l.useMemo(()=>j.filter(s=>s.status!=="done"),[j]),$=l.useMemo(()=>j.filter(s=>s.status==="done"),[j]),We=l.useCallback(async s=>{const{source:n,destination:t,draggableId:p}=s;if(!t||n.droppableId===t.droppableId&&n.index===t.index)return;const c=n.droppableId,y=t.droppableId,f=c==="pending",O=y==="pending",i=f?H:$,m=O?H:$;let x=0;if(c===y){const d=Array.from(i),[U]=d.splice(n.index,1);d.splice(t.index,0,U);const z=d[t.index-1],F=d[t.index+1],K=z?z.order??0:null,ce=F?F.order??0:null;z&&F?x=((K??0)+(ce??0))/2:z?x=(K??0)-1e5:F?x=(ce??0)+1e5:x=Date.now()}else{const d=m;if(d.length===0)x=Date.now();else if(t.index===0)x=(d[0].order??0)+1e5;else if(t.index>=d.length)x=(d[d.length-1].order??0)-1e5;else{const U=d[t.index-1],z=d[t.index];x=((U.order??0)+(z.order??0))/2}}q(d=>{const U=d.findIndex(K=>K.id===p);if(U===-1)return d;const z={...d[U],order:x,status:y==="completed"?"done":"todo"},F=[...d];return F[U]=z,F.sort((K,ce)=>(ce.order??0)-(K.order??0)),F});try{const d={order:x};c!==y&&(d.status=y==="completed"?"done":"todo"),await qe(we(_,"user_tasks",p),d)}catch(d){console.error("Error moving task:",d),T.error("Error al mover la tarea")}},[H,$]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-foreground",children:"Tareas"}),e.jsx("p",{className:"mt-1 text-base text-muted-foreground",children:"Tu gestor de tareas personal (Privado)"})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>{v?ue():C(!0)},className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors group",children:[e.jsx("span",{className:h("flex items-center justify-center h-6 w-6 rounded-full border transition-all",v?"border-yellow-400 bg-yellow-400/20 text-black dark:text-yellow-500":"border-yellow-400/60 bg-yellow-400/10 group-hover:bg-yellow-400/20 group-hover:border-yellow-400 text-black dark:text-yellow-500"),children:v?e.jsx(ds,{className:"h-3.5 w-3.5"}):e.jsx(X,{className:"h-3.5 w-3.5"})}),"Nueva tarea"]}),Ee&&e.jsxs("button",{onClick:()=>he(!0),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors group",children:[e.jsx("span",{className:"flex items-center justify-center h-6 w-6 rounded-full border border-primary/40 bg-primary/10 group-hover:bg-primary/20 group-hover:border-primary transition-all text-black dark:text-primary",children:e.jsx(ke,{className:"h-3.5 w-3.5"})}),"Asignar tarea"]})]}),(v||o)&&e.jsxs("div",{onAnimationEnd:()=>{o&&(C(!1),r(!1))},className:h("flex flex-col gap-2 bg-card p-3 rounded-xl border border-primary/20 shadow-sm max-w-lg mt-2 overflow-hidden",o?"animate-out fade-out slide-out-to-top-2 duration-200 fill-mode-forwards":"animate-in fade-in slide-in-from-top-2 duration-200"),children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(te,{placeholder:"Título de la tarea...",value:D,onChange:s=>E(s.target.value),onKeyDown:s=>s.key==="Enter"&&de(),autoFocus:!0,className:"h-8 text-sm px-3 flex-1 min-w-0"}),e.jsxs(G,{value:M,onValueChange:A,children:[e.jsx(J,{className:h("h-8 w-auto min-w-[88px] text-xs px-2 shrink-0 border-0 focus:ring-1 gap-1",Se[M]||"bg-muted text-muted-foreground"),children:e.jsx(Q,{})}),e.jsx(W,{children:re.map(s=>e.jsx(Y,{value:s,className:"text-xs",children:s},s))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap min-w-0",children:[e.jsx(k,{value:N,onChange:S,placeholder:"Inicio",className:"h-7 w-auto max-w-[140px] text-xs"}),e.jsx(k,{value:ne,onChange:oe,placeholder:"Límite",className:"h-7 w-auto max-w-[140px] text-xs"}),e.jsx("div",{className:"flex-1"}),e.jsxs(V,{size:"sm",onClick:async()=>{await de()&&ue()},disabled:!D.trim(),className:"h-7 text-xs px-3 gap-1 shrink-0",children:[e.jsx(X,{className:"h-3 w-3"})," Agregar"]})]})]})]}),e.jsx("button",{type:"button",onClick:()=>g(!0),className:"md:hidden fixed bottom-20 right-4 z-50 h-14 w-14 rounded-full bg-primary text-primary-foreground shadow-lg flex items-center justify-center hover:bg-primary/90 transition-colors","aria-label":"Nueva tarea",children:e.jsx(X,{className:"h-6 w-6"})}),e.jsx(as,{open:ee&&L,onOpenChange:s=>{g(s),s||P("create")},children:e.jsxs(ts,{side:"bottom",className:"md:hidden rounded-t-2xl px-4 pb-8 pt-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"mx-auto mb-4 h-1 w-10 rounded-full bg-muted-foreground/30"}),e.jsx(rs,{className:"mb-4",children:e.jsx(ns,{className:"text-left",children:Ee?e.jsxs("div",{className:"flex gap-1 p-1 bg-muted rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>P("create"),className:h("flex-1 py-1.5 text-sm font-medium rounded-md transition-colors",I==="create"?"bg-background text-foreground shadow-sm":"text-muted-foreground"),children:"Para mí"}),e.jsx("button",{type:"button",onClick:()=>P("assign"),className:h("flex-1 py-1.5 text-sm font-medium rounded-md transition-colors",I==="assign"?"bg-background text-foreground shadow-sm":"text-muted-foreground"),children:"Asignar"})]}):"Nueva tarea"})}),I==="create"?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(te,{placeholder:"Título de la tarea...",value:D,onChange:s=>E(s.target.value),onKeyDown:async s=>{s.key==="Enter"&&await de()&&g(!1)},className:"w-full",autoFocus:!0}),e.jsx("select",{value:M,onChange:s=>A(s.target.value),className:"h-10 w-full rounded-md border border-border bg-card px-4 py-2 text-sm text-foreground cursor-pointer focus:outline-none focus:ring-2 focus:ring-ring",children:re.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx(k,{value:N,onChange:S,placeholder:"Fecha inicio"}),e.jsx(k,{value:ne,onChange:oe,placeholder:"Fecha límite"}),e.jsxs(V,{onClick:async()=>{await de()&&g(!1)},disabled:!D.trim(),className:"w-full gap-1.5",children:[e.jsx(X,{className:"h-4 w-4"})," Agregar tarea"]})]}):e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(G,{value:ae,onValueChange:je,children:[e.jsx(J,{children:e.jsx(Q,{placeholder:"Asignar a..."})}),e.jsx(W,{children:Je.filter(s=>s.email!==(a==null?void 0:a.email)).map(s=>e.jsx(Y,{value:s.email,children:s.label},s.email))})]}),e.jsx(te,{placeholder:"Título de la tarea...",value:se,onChange:s=>ge(s.target.value)}),e.jsxs(G,{value:pe,onValueChange:fe,children:[e.jsx(J,{children:e.jsx(Q,{})}),e.jsx(W,{children:re.map(s=>e.jsx(Y,{value:s,children:s},s))})]}),e.jsx(k,{value:le,onChange:ye,placeholder:"Fecha inicio"}),e.jsx(k,{value:ie,onChange:Ne,placeholder:"Fecha límite"}),e.jsx(Te,{placeholder:"Notas (opcional)...",value:be,onChange:s=>ve(s.target.value),className:"min-h-[70px] text-sm resize-none"}),e.jsxs(V,{onClick:async()=>{await Ie(),g(!1)},disabled:!se.trim()||!ae,className:"w-full gap-1.5",children:[e.jsx(ke,{className:"h-4 w-4"})," Asignar tarea"]})]})]})}),e.jsx(Ns,{open:Qe,onOpenChange:he,assignTitle:se,setAssignTitle:ge,assignPriority:pe,setAssignPriority:fe,assignTo:ae,setAssignTo:je,assignNotes:be,setAssignNotes:ve,assignSubtasks:Me,setAssignSubtasks:Ae,assignStartDate:le,setAssignStartDate:ye,assignDueDate:ie,setAssignDueDate:Ne,assignTask:Ie,userEmail:(a==null?void 0:a.email)??void 0}),e.jsx(cs,{onDragEnd:We,children:e.jsxs("div",{className:h("grid gap-4 md:gap-6",L?"grid-cols-1":"lg:grid-cols-2"),children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-medium text-muted-foreground mb-3",children:["Pendientes (",H.length,")"]}),e.jsx($e,{droppableId:"pending",children:s=>e.jsxs("div",{ref:s.innerRef,...s.droppableProps,className:"space-y-2 min-h-[100px] rounded-xl border border-dashed border-border p-3",children:[u?e.jsx("p",{className:"text-xs text-muted-foreground text-center py-8 italic",children:"Cargando..."}):H.map((n,t)=>e.jsx(Ge,{task:n,index:t,expandedTasks:w,toggleExpand:Pe,updateTask:R,deleteTask:ze,addSubtask:Fe,toggleSubtask:Le,updateSubtaskTitle:Oe,deleteSubtask:Ue},n.id)),!u&&H.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-8",children:"No hay tareas pendientes"}),s.placeholder]})})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-medium text-success mb-3",children:["Completadas (",$.length,")"]}),e.jsx($e,{droppableId:"completed",children:s=>e.jsxs("div",{ref:s.innerRef,...s.droppableProps,className:"space-y-2 min-h-[100px] rounded-xl border border-dashed border-success/30 bg-success/5 p-3",children:[u?e.jsx("p",{className:"text-xs text-muted-foreground text-center py-8 italic",children:"Cargando..."}):$.map((n,t)=>e.jsx(Ge,{task:n,index:t,expandedTasks:w,toggleExpand:Pe,updateTask:R,deleteTask:ze,addSubtask:Fe,toggleSubtask:Le,updateSubtaskTitle:Oe,deleteSubtask:Ue},n.id)),!u&&$.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-8",children:"No hay tareas completadas"}),s.placeholder]})})]})]})})]})};export{zs as default};
